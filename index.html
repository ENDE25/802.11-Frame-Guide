<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diccionario Definitivo de Trama 802.11</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
            --warning: #f39c12;
            --info: #1abc9c;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a3a, #2c3e50);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(44, 62, 80, 0.7);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--light);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--secondary);
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(52, 73, 94, 0.6);
            padding: 20px;
            border-radius: 10px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            min-width: 200px;
        }
        
        label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--light);
        }
        
        select {
            padding: 12px;
            border-radius: 6px;
            border: 2px solid var(--secondary);
            background: var(--dark);
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.3);
        }
        
        .frame-display {
            margin-top: 30px;
            overflow-x: auto;
            background: rgba(44, 62, 80, 0.7);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .frame-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .frame-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--secondary);
        }
        
        .frame-size {
            color: var(--warning);
            font-weight: 600;
        }
        
        .frame-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .frame-cell {
            border: 2px solid var(--secondary);
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            font-weight: 500;
            min-width: 80px;
        }
        
        .frame-cell:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }
        
        .frame-cell.active {
            background: rgba(52, 152, 219, 0.4);
            border-color: var(--accent);
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        }
        
        .bit-size {
            position: absolute;
            bottom: 4px;
            right: 4px;
            font-size: 0.7rem;
            color: var(--warning);
        }
        
        .field-details {
            background: rgba(52, 73, 94, 0.8);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            animation: fadeIn 0.3s ease;
        }
        
        .field-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
        }
        
        .field-name {
            font-size: 1.3rem;
            color: var(--accent);
            font-weight: 600;
        }
        
        .field-description {
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .values-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .values-table th {
            background: var(--primary);
            padding: 12px;
            text-align: left;
        }
        
        .values-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(236, 240, 241, 0.1);
        }
        
        .values-table tr:nth-child(even) {
            background: rgba(44, 62, 80, 0.5);
        }
        
        .value {
            font-family: monospace;
            color: var(--success);
        }
        
        .meaning {
            color: var(--light);
        }
        
        .no-details {
            text-align: center;
            padding: 20px;
            color: var(--warning);
            font-style: italic;
        }
        
        .subfield-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--secondary);
            font-size: 0.9rem;
        }
        
        .field-path {
            color: var(--info);
            font-style: italic;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-group {
                width: 100%;
            }
            
            .frame-table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Diccionario Interactivo de Tramas 802.11</h1>
            <p class="subtitle">Explora interactivamente todos los tipos de tramas WiFi. Selecciona versión, tipo y subtipo para ver la estructura detallada. Haz clic en cualquier campo para ver su composición interna o información detallada.</p>
        </header>
        
        <div class="controls">
            <div class="control-group">
                <label for="version-select">Versión WiFi:</label>
                <select id="version-select">
                    <option value="all">Todas las versiones</option>
                    <option value="legacy">Legacy (802.11-1997)</option>
                    <option value="802.11a">802.11a</option>
                    <option value="802.11b">802.11b</option>
                    <option value="802.11g">802.11g</option>
                    <option value="802.11n">802.11n (WiFi 4)</option>
                    <option value="802.11ac" selected>802.11ac (WiFi 5)</option>
                    <option value="802.11ax">802.11ax (WiFi 6)</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="type-select">Tipo de Trama:</label>
                <select id="type-select">
                    <option value="management">Management</option>
                    <option value="control">Control</option>
                    <option value="data" selected>Data</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="subtype-select">Subtipo de Trama:</label>
                <select id="subtype-select">
                    <!-- Se llenará dinámicamente según el tipo seleccionado -->
                </select>
            </div>
        </div>
        
        <div class="frame-display">
            <div class="frame-header">
                <div class="frame-title">Trama: <span id="frame-name">Data - QoS Data</span></div>
                <div class="frame-size">Tamaño: <span id="frame-size">24-34 bytes (dependiendo de flags)</span></div>
            </div>
            
            <div id="frame-container">
                <!-- La estructura de la trama se generará aquí dinámicamente -->
            </div>
            
            <div id="field-details-container">
                <!-- Los detalles del campo se generarán aquí dinámicamente -->
            </div>
        </div>
        
        <footer>
            <p>Diccionario Definitivo de Trama 802.11 | Basado en el estándar IEEE 802.11 | by ENDE</p>
        </footer>
    </div>

    <script>
        // Datos de tipos y subtipos de tramas
        const frameTypes = {
            management: [
                { id: 'assoc-req', name: 'Association Request', size: '32 bytes' },
                { id: 'assoc-res', name: 'Association Response', size: '34 bytes' },
                { id: 'reassoc-req', name: 'Reassociation Request', size: '36 bytes' },
                { id: 'reassoc-res', name: 'Reassociation Response', size: '38 bytes' },
                { id: 'probe-req', name: 'Probe Request', size: '24 bytes' },
                { id: 'probe-res', name: 'Probe Response', size: '40+ bytes' },
                { id: 'beacon', name: 'Beacon', size: '62+ bytes' },
                { id: 'atim', name: 'ATIM', size: '24 bytes' },
                { id: 'disassoc', name: 'Disassociation', size: '26 bytes' },
                { id: 'auth', name: 'Authentication', size: '30+ bytes' },
                { id: 'deauth', name: 'Deauthentication', size: '26 bytes' },
                { id: 'action', name: 'Action', size: '28+ bytes' }
            ],
            control: [
                { id: 'rts', name: 'RTS (Request to Send)', size: '20 bytes' },
                { id: 'cts', name: 'CTS (Clear to Send)', size: '14 bytes' },
                { id: 'ack', name: 'ACK (Acknowledgement)', size: '14 bytes' },
                { id: 'ps-poll', name: 'PS-Poll', size: '20 bytes' },
                { id: 'cf-end', name: 'CF-End', size: '20 bytes' },
                { id: 'cf-end-ack', name: 'CF-End+CF-Ack', size: '20 bytes' },
                { id: 'block-ack-req', name: 'Block Ack Request', size: '24 bytes' },
                { id: 'block-ack', name: 'Block Ack', size: '32 bytes' },
                { id: 'control-wrapper', name: 'Control Wrapper', size: '28+ bytes' }
            ],
            data: [
                { id: 'data', name: 'Data', size: '28+ bytes' },
                { id: 'data-cf-ack', name: 'Data+CF-Ack', size: '28+ bytes' },
                { id: 'data-cf-poll', name: 'Data+CF-Poll', size: '28+ bytes' },
                { id: 'data-cf-ack-poll', name: 'Data+CF-Ack+CF-Poll', size: '28+ bytes' },
                { id: 'null', name: 'Null (no data)', size: '24 bytes' },
                { id: 'cf-ack', name: 'CF-Ack (no data)', size: '24 bytes' },
                { id: 'cf-poll', name: 'CF-Poll (no data)', size: '24 bytes' },
                { id: 'cf-ack-poll', name: 'CF-Ack+CF-Poll (no data)', size: '24 bytes' },
                { id: 'qos-data', name: 'QoS Data', size: '26+ bytes', selected: true },
                { id: 'qos-data-cf-ack', name: 'QoS Data+CF-Ack', size: '26+ bytes' },
                { id: 'qos-data-cf-poll', name: 'QoS Data+CF-Poll', size: '26+ bytes' },
                { id: 'qos-data-cf-ack-poll', name: 'QoS Data+CF-Ack+CF-Poll', size: '26+ bytes' },
                { id: 'qos-null', name: 'QoS Null (no data)', size: '26 bytes' },
                { id: 'qos-cf-poll', name: 'QoS CF-Poll (no data)', size: '26 bytes' },
                { id: 'qos-cf-ack-poll', name: 'QoS CF-Ack+CF-Poll (no data)', size: '26 bytes' }
            ]
        };

        // Estructuras de tramas
        const frameStructures = {
            'management': {
                'beacon': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration', size: '16 bits' },
                    { id: 'address1', name: 'Destination Address', size: '48 bits' },
                    { id: 'address2', name: 'Source Address', size: '48 bits' },
                    { id: 'address3', name: 'BSSID', size: '48 bits' },
                    { id: 'sequence', name: 'Sequence Control', size: '16 bits' },
                    { id: 'timestamp', name: 'Timestamp', size: '64 bits' },
                    { id: 'beacon-interval', name: 'Beacon Interval', size: '16 bits' },
                    { id: 'capabilities', name: 'Capabilities', size: '16 bits' },
                    { id: 'ssid', name: 'SSID', size: 'variable' },
                    { id: 'rates', name: 'Supported Rates', size: 'variable' },
                    { id: 'ds-params', name: 'DS Parameters', size: '8 bits' },
                    { id: 'tim', name: 'TIM', size: 'variable' },
                    { id: 'country', name: 'Country', size: 'variable' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ],
                'probe-req': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration', size: '16 bits' },
                    { id: 'address1', name: 'Destination Address', size: '48 bits' },
                    { id: 'address2', name: 'Source Address', size: '48 bits' },
                    { id: 'address3', name: 'BSSID', size: '48 bits' },
                    { id: 'sequence', name: 'Sequence Control', size: '16 bits' },
                    { id: 'ssid', name: 'SSID', size: 'variable' },
                    { id: 'rates', name: 'Supported Rates', size: 'variable' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ]
            },
            'control': {
                'ack': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration', size: '16 bits' },
                    { id: 'address1', name: 'Receiver Address', size: '48 bits' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ],
                'rts': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration', size: '16 bits' },
                    { id: 'address1', name: 'Receiver Address', size: '48 bits' },
                    { id: 'address2', name: 'Transmitter Address', size: '48 bits' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ],
                'cts': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration', size: '16 bits' },
                    { id: 'address1', name: 'Receiver Address', size: '48 bits' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ]
            },
            'data': {
                'qos-data': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration/ID', size: '16 bits' },
                    { id: 'address1', name: 'Address 1', size: '48 bits' },
                    { id: 'address2', name: 'Address 2', size: '48 bits' },
                    { id: 'address3', name: 'Address 3', size: '48 bits' },
                    { id: 'sequence', name: 'Sequence Control', size: '16 bits' },
                    { id: 'qos', name: 'QoS Control', size: '16 bits' },
                    { id: 'ht-control', name: 'HT Control', size: '32 bits' },
                    { id: 'frame-body', name: 'Frame Body', size: '0-7951 bytes' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ],
                'data': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration/ID', size: '16 bits' },
                    { id: 'address1', name: 'Address 1', size: '48 bits' },
                    { id: 'address2', name: 'Address 2', size: '48 bits' },
                    { id: 'address3', name: 'Address 3', size: '48 bits' },
                    { id: 'sequence', name: 'Sequence Control', size: '16 bits' },
                    { id: 'address4', name: 'Address 4', size: '48 bits' },
                    { id: 'frame-body', name: 'Frame Body', size: '0-7951 bytes' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ],
                'null': [
                    { id: 'frame-control', name: 'Frame Control', size: '16 bits' },
                    { id: 'duration', name: 'Duration/ID', size: '16 bits' },
                    { id: 'address1', name: 'Address 1', size: '48 bits' },
                    { id: 'address2', name: 'Address 2', size: '48 bits' },
                    { id: 'address3', name: 'Address 3', size: '48 bits' },
                    { id: 'sequence', name: 'Sequence Control', size: '16 bits' },
                    { id: 'fcs', name: 'FCS', size: '32 bits' }
                ]
            }
        };

        // Añadir descripciones y valores a todos los campos y subcampos principales
        const fieldDetails = {
            'frame-control': {
                name: 'Frame Control',
                size: '16 bits',
                description: 'Define el tipo de trama y contiene varios indicadores de control. Determina cómo se interpreta el resto de la trama y contiene información sobre la versión del protocolo, tipo de trama, subtipo y varios flags de control.',
                subfields: [
                    { id: 'protocol', name: 'Protocol Version', size: '2 bits', description: 'Indica la versión del estándar 802.11 utilizada para la trama.', values: [
                        { value: '00', meaning: '802.11-1997/802.11b/802.11a/802.11g/802.11n/802.11ac/ax (actual)' },
                        { value: '01', meaning: 'Reservado para futuras versiones' },
                        { value: '10', meaning: 'Reservado para futuras versiones' },
                        { value: '11', meaning: 'Reservado para futuras versiones' }
                    ] },
                    { id: 'type', name: 'Type', size: '2 bits', description: 'Indica el tipo principal de la trama: Management, Control o Data.', values: [
                        { value: '00', meaning: 'Management Frame' },
                        { value: '01', meaning: 'Control Frame' },
                        { value: '10', meaning: 'Data Frame' },
                        { value: '11', meaning: 'Reservado' }
                    ] },
                    { id: 'subtype', name: 'Subtype', size: '4 bits', description: 'Especifica el subtipo exacto de la trama dentro de su tipo principal.' },
                    { id: 'to-ds', name: 'To DS', size: '1 bit', description: 'Indica si la trama está destinada a un sistema de distribución (DS), como un punto de acceso.', values: [
                        { value: '0', meaning: 'No va hacia el sistema de distribución (DS)' },
                        { value: '1', meaning: 'Va hacia el sistema de distribución (DS)' }
                    ] },
                    { id: 'from-ds', name: 'From DS', size: '1 bit', description: 'Indica si la trama proviene de un sistema de distribución (DS), como un punto de acceso.', values: [
                        { value: '0', meaning: 'No proviene del sistema de distribución (DS)' },
                        { value: '1', meaning: 'Proviene del sistema de distribución (DS)' }
                    ] },
                    { id: 'more-frag', name: 'More Fragments', size: '1 bit', description: 'Indica si hay más fragmentos de la trama por recibir.', values: [
                        { value: '0', meaning: 'Último fragmento o trama no fragmentada' },
                        { value: '1', meaning: 'Hay más fragmentos después de este' }
                    ] },
                    { id: 'retry', name: 'Retry', size: '1 bit', description: 'Indica si la trama es una retransmisión de una trama anterior.', values: [
                        { value: '0', meaning: 'Primera transmisión de la trama' },
                        { value: '1', meaning: 'Retransmisión de una trama anterior' }
                    ] },
                    { id: 'power', name: 'Power Management', size: '1 bit', description: 'Indica el modo de gestión de energía del emisor tras esta trama.', values: [
                        { value: '0', meaning: 'El emisor permanece en modo activo' },
                        { value: '1', meaning: 'El emisor entra en modo ahorro de energía' }
                    ] },
                    { id: 'more-data', name: 'More Data', size: '1 bit', description: 'Indica si hay más datos pendientes para el receptor en el AP o estación.', values: [
                        { value: '0', meaning: 'No hay más datos pendientes' },
                        { value: '1', meaning: 'Hay más datos pendientes para el receptor' }
                    ] },
                    { id: 'protected', name: 'Protected Frame', size: '1 bit', description: 'Indica si el cuerpo de la trama está cifrado (protección de datos).', values: [
                        { value: '0', meaning: 'Trama sin cifrar' },
                        { value: '1', meaning: 'Trama cifrada (WEP, WPA, WPA2, WPA3)' }
                    ] },
                    { id: 'htc-order', name: '+HTC/Order', size: '1 bit', description: 'Indica si la trama contiene un campo HT Control (para 802.11n/ac/ax) o si se debe mantener el orden de entrega.', values: [
                        { value: '0', meaning: 'No contiene campo HT Control / No requiere orden estricto' },
                        { value: '1', meaning: 'Contiene campo HT Control / Requiere orden estricto' }
                    ] }
                ]
            },
            'protocol': {
                name: 'Protocol Version',
                size: '2 bits',
                description: 'Indica la versión del estándar 802.11 utilizada para la trama.',
                values: [
                    { value: '00', meaning: '802.11-1997/802.11b/802.11a/802.11g/802.11n/802.11ac/ax (actual)' },
                    { value: '01', meaning: 'Reservado para futuras versiones' },
                    { value: '10', meaning: 'Reservado para futuras versiones' },
                    { value: '11', meaning: 'Reservado para futuras versiones' }
                ]
            },
            'type': {
                name: 'Type (Frame Control)',
                size: '2 bits',
                description: 'Indica el tipo principal de la trama: Management, Control o Data.',
                values: [
                    { value: '00', meaning: 'Management Frame' },
                    { value: '01', meaning: 'Control Frame' },
                    { value: '10', meaning: 'Data Frame' },
                    { value: '11', meaning: 'Reservado' }
                ]
            },
            'subtype': {
                name: 'Subtype (Frame Control)',
                size: '4 bits',
                description: 'Especifica el subtipo exacto de la trama dentro de su tipo principal.'
            },
            'to-ds': {
                name: 'To DS',
                size: '1 bit',
                description: 'Indica si la trama está destinada a un sistema de distribución (DS), como un punto de acceso.',
                values: [
                    { value: '0', meaning: 'No va hacia el sistema de distribución (DS)' },
                    { value: '1', meaning: 'Va hacia el sistema de distribución (DS)' }
                ]
            },
            'from-ds': {
                name: 'From DS',
                size: '1 bit',
                description: 'Indica si la trama proviene de un sistema de distribución (DS), como un punto de acceso.',
                values: [
                    { value: '0', meaning: 'No proviene del sistema de distribución (DS)' },
                    { value: '1', meaning: 'Proviene del sistema de distribución (DS)' }
                ]
            },
            'more-frag': {
                name: 'More Fragments',
                size: '1 bit',
                description: 'Indica si hay más fragmentos de la trama por recibir.',
                values: [
                    { value: '0', meaning: 'Último fragmento o trama no fragmentada' },
                    { value: '1', meaning: 'Hay más fragmentos después de este' }
                ]
            },
            'retry': {
                name: 'Retry',
                size: '1 bit',
                description: 'Indica si la trama es una retransmisión de una trama anterior.',
                values: [
                    { value: '0', meaning: 'Primera transmisión de la trama' },
                    { value: '1', meaning: 'Retransmisión de una trama anterior' }
                ]
            },
            'power': {
                name: 'Power Management',
                size: '1 bit',
                description: 'Indica el modo de gestión de energía del emisor tras esta trama.',
                values: [
                    { value: '0', meaning: 'El emisor permanece en modo activo' },
                    { value: '1', meaning: 'El emisor entra en modo ahorro de energía' }
                ]
            },
            'more-data': {
                name: 'More Data',
                size: '1 bit',
                description: 'Indica si hay más datos pendientes para el receptor en el AP o estación.',
                values: [
                    { value: '0', meaning: 'No hay más datos pendientes' },
                    { value: '1', meaning: 'Hay más datos pendientes para el receptor' }
                ]
            },
            'protected': {
                name: 'Protected Frame',
                size: '1 bit',
                description: 'Indica si el cuerpo de la trama está cifrado (protección de datos).',
                values: [
                    { value: '0', meaning: 'Trama sin cifrar' },
                    { value: '1', meaning: 'Trama cifrada (WEP, WPA, WPA2, WPA3)' }
                ]
            },
            'htc-order': {
                name: '+HTC/Order',
                size: '1 bit',
                description: 'Indica si la trama contiene un campo HT Control (para 802.11n/ac/ax) o si se debe mantener el orden de entrega.',
                values: [
                    { value: '0', meaning: 'No contiene campo HT Control / No requiere orden estricto' },
                    { value: '1', meaning: 'Contiene campo HT Control / Requiere orden estricto' }
                ]
            },
            'duration': {
                name: 'Duration/ID',
                size: '16 bits',
                description: 'Tiene diferentes significados dependiendo del tipo de trama. En tramas de control, indica el tiempo necesario para completar la transmisión. En PS-Poll, contiene el AID del cliente.',
                values: [
                    { value: '0-32767', meaning: 'Duración en microsegundos' },
                    { value: '32768', meaning: 'Contention-Free Period (CFP)' },
                    { value: '65535', meaning: 'Trama de Broadcast' }
                ]
            },
            'address1': {
                name: 'Address 1',
                size: '48 bits',
                description: 'Dirección MAC del receptor. En tramas de datos, puede ser la dirección del AP o del cliente dependiendo de la dirección.'
            },
            'address2': {
                name: 'Address 2',
                size: '48 bits',
                description: 'Dirección MAC del transmisor. En tramas de datos, generalmente es la dirección del cliente o del AP que está enviando la trama.'
            },
            'address3': {
                name: 'Address 3',
                size: '48 bits',
                description: 'Se utiliza para filtrado en estaciones. En tramas de datos, suele ser la dirección BSSID (dirección MAC del AP).'
            },
            'address4': {
                name: 'Address 4',
                size: '48 bits',
                description: 'Campo opcional en tramas de datos cuando To DS y From DS están activos. Usado en redes WDS.'
            },
            'sequence': {
                name: 'Sequence Control',
                size: '16 bits',
                description: 'Contiene el número de secuencia y el número de fragmento. Ayuda a mantener el orden de los paquetes y detectar duplicados.',
                subfields: [
                    { id: 'fragment', name: 'Fragment Number', size: '4 bits', description: 'Número de fragmento de la trama. Permite reensamblar tramas fragmentadas.', values: [
                        { value: '0000', meaning: 'Fragmento único o primer fragmento' },
                        { value: '0001-1111', meaning: 'Fragmentos subsiguientes (hasta 15)' }
                    ] },
                    { id: 'sequence-num', name: 'Sequence Number', size: '12 bits', description: 'Número de secuencia de la trama. Permite ordenar y detectar duplicados.', values: [
                        { value: '0-4095', meaning: 'Número de secuencia de la trama (incrementa por cada nueva trama)' }
                    ] }
                ]
            },
            'fragment': {
                name: 'Fragment Number',
                size: '4 bits',
                description: 'Número de fragmento de la trama. Permite reensamblar tramas fragmentadas.',
                values: [
                    { value: '0000', meaning: 'Fragmento único o primer fragmento' },
                    { value: '0001-1111', meaning: 'Fragmentos subsiguientes (hasta 15)' }
                ]
            },
            'sequence-num': {
                name: 'Sequence Number',
                size: '12 bits',
                description: 'Número de secuencia de la trama. Permite ordenar y detectar duplicados.',
                values: [
                    { value: '0-4095', meaning: 'Número de secuencia de la trama (incrementa por cada nueva trama)' }
                ]
            },
            'qos': {
                name: 'QoS Control',
                size: '16 bits',
                description: 'Presente solo en tramas QoS Data. Contiene información sobre la prioridad del tráfico, control de admisión y otros parámetros QoS.',
                subfields: [
                    { id: 'tid', name: 'TID (Traffic Identifier)', size: '4 bits', description: 'Identificador de tráfico para QoS. Indica la prioridad del tráfico.', values: [
                        { value: '0000', meaning: 'Background' },
                        { value: '0001', meaning: 'Best Effort' },
                        { value: '0010', meaning: 'Video' },
                        { value: '0011', meaning: 'Voice' },
                        { value: '0100-1001', meaning: 'Reservado' },
                        { value: '1010-1111', meaning: 'Gestión' }
                    ] },
                    { id: 'eosp', name: 'EOSP (End of Service Period)', size: '1 bit', description: 'Indica si esta trama es la última de un periodo de servicio QoS.', values: [
                        { value: '0', meaning: 'No es la última trama del periodo de servicio' },
                        { value: '1', meaning: 'Última trama del periodo de servicio' }
                    ] },
                    { id: 'ack-policy', name: 'ACK Policy', size: '2 bits', description: 'Define la política de acuse de recibo (ACK) para la trama.', values: [
                        { value: '00', meaning: 'Normal ACK' },
                        { value: '01', meaning: 'No ACK requerido' },
                        { value: '10', meaning: 'No ACK (Reserved)' },
                        { value: '11', meaning: 'Block ACK' }
                    ] },
                    { id: 'txop-limit', name: 'TXOP Limit', size: '8 bits', description: 'Indica el límite de tiempo (en microsegundos) para la transmisión de datos en un periodo de oportunidad de transmisión (TXOP).', values: [
                        { value: '0-255', meaning: 'Límite de tiempo para la transmisión (en unidades de 32 microsegundos)' }
                    ] }
                ]
            },
            'tid': {
                name: 'TID (Traffic Identifier)',
                size: '4 bits',
                description: 'Identificador de tráfico para QoS. Indica la prioridad del tráfico.',
                values: [
                    { value: '0000', meaning: 'Background' },
                    { value: '0001', meaning: 'Best Effort' },
                    { value: '0010', meaning: 'Video' },
                    { value: '0011', meaning: 'Voice' },
                    { value: '0100-1001', meaning: 'Reservado' },
                    { value: '1010-1111', meaning: 'Gestión' }
                ]
            },
            'eosp': {
                name: 'EOSP (End of Service Period)',
                size: '1 bit',
                description: 'Indica si esta trama es la última de un periodo de servicio QoS.',
                values: [
                    { value: '0', meaning: 'No es la última trama del periodo de servicio' },
                    { value: '1', meaning: 'Última trama del periodo de servicio' }
                ]
            },
            'ack-policy': {
                name: 'ACK Policy',
                size: '2 bits',
                description: 'Define la política de acuse de recibo (ACK) para la trama.',
                values: [
                    { value: '00', meaning: 'Normal ACK' },
                    { value: '01', meaning: 'No ACK requerido' },
                    { value: '10', meaning: 'No ACK (Reserved)' },
                    { value: '11', meaning: 'Block ACK' }
                ]
            },
            'txop-limit': {
                name: 'TXOP Limit',
                size: '8 bits',
                description: 'Indica el límite de tiempo (en microsegundos) para la transmisión de datos en un periodo de oportunidad de transmisión (TXOP).',
                values: [
                    { value: '0-255', meaning: 'Límite de tiempo para la transmisión (en unidades de 32 microsegundos)' }
                ]
            },
            'timestamp': {
                name: 'Timestamp',
                size: '64 bits',
                description: 'Marca de tiempo de 8 bytes que indica el momento en que se generó la trama Beacon. Se utiliza para sincronización entre estaciones y puntos de acceso.'
            },
            'beacon-interval': {
                name: 'Beacon Interval',
                size: '16 bits',
                description: 'Especifica el intervalo de tiempo entre tramas Beacon en unidades de tiempo (TU). Un TU equivale a 1024 microsegundos.',
                values: [
                    { value: '100', meaning: 'Intervalo de 102.4 ms' },
                    { value: '200', meaning: 'Intervalo de 204.8 ms' }
                ]
            },
            'capabilities': {
                name: 'Capabilities',
                size: '16 bits',
                description: 'Campo de 16 bits que indica las capacidades del punto de acceso o estación (soporte de ESS, IBSS, privacidad, corto preámbulo, etc.).',
                values: [
                    { value: 'bit 0', meaning: 'ESS (Extended Service Set)' },
                    { value: 'bit 1', meaning: 'IBSS (Independent BSS)' },
                    { value: 'bit 4', meaning: 'Privacy (WEP habilitado)' },
                    { value: 'bit 5', meaning: 'Short Preamble' },
                    { value: 'bit 6', meaning: 'PBCC' },
                    { value: 'bit 7', meaning: 'Channel Agility' },
                    { value: 'bit 8', meaning: 'Spectrum Management' },
                    { value: 'bit 9', meaning: 'QoS' },
                    { value: 'bit 10', meaning: 'Short Slot Time' },
                    { value: 'bit 11', meaning: 'APSD' },
                    { value: 'bit 12', meaning: 'Radio Measurement' },
                    { value: 'bit 13', meaning: 'DSSS-OFDM' },
                    { value: 'bit 14', meaning: 'Delayed Block Ack' },
                    { value: 'bit 15', meaning: 'Immediate Block Ack' }
                ]
            },
            'ssid': {
                name: 'Service Set Identifier',
                size: '0-32 bytes',
                description: 'Identificador de la red inalámbrica. Puede estar oculto (longitud 0) o tener hasta 32 caracteres.'
            },
            'rates': {
                name: 'Supported Rates',
                size: '1-8 bytes',
                description: 'Lista de tasas de datos soportadas por el punto de acceso.',
                values: [
                    { value: '0x82', meaning: '1 Mbps' },
                    { value: '0x84', meaning: '2 Mbps' },
                    { value: '0x8B', meaning: '5.5 Mbps' },
                    { value: '0x96', meaning: '11 Mbps' }
                ]
            },
            'ds-params': {
                name: 'DS Parameters',
                size: '8 bits',
                description: 'Indica el canal de frecuencia utilizado en la red (número de canal de 1 a 14 en 2.4 GHz).',
                values: [
                    { value: '1-14', meaning: 'Número de canal en la banda de 2.4 GHz' }
                ]
            },
            'tim': {
                name: 'Traffic Indication Map (TIM)',
                size: 'variable',
                description: 'Indica qué estaciones tienen datos pendientes en el AP. Incluye el campo DTIM para multicast/broadcast.'
            },
            'country': {
                name: 'Country',
                size: 'variable',
                description: 'Indica la región/regulación de radiofrecuencia y los canales permitidos.'
            },
            'frame-body': {
                name: 'Frame Body',
                size: 'variable',
                description: 'Contiene los datos de la trama, que pueden ser información de gestión, control o datos de usuario, según el tipo de trama.'
            },
            'ht-control': {
                name: 'HT Control',
                size: '32 bits',
                description: 'Campo presente en tramas 802.11n/ac/ax para control avanzado de transmisión (información de agregación, control de canal, etc.).'
            },
            'fcs': {
                name: 'Frame Check Sequence',
                size: '32 bits',
                description: 'Contiene un valor CRC-32 para verificar la integridad de la trama. Si el cálculo no coincide, la trama se descarta.'
            }
        };

        // Inicializar la página
        document.addEventListener('DOMContentLoaded', function() {
            const versionSelect = document.getElementById('version-select');
            const typeSelect = document.getElementById('type-select');
            const subtypeSelect = document.getElementById('subtype-select');
            const frameName = document.getElementById('frame-name');
            const frameSize = document.getElementById('frame-size');
            const frameContainer = document.getElementById('frame-container');
            const fieldDetailsContainer = document.getElementById('field-details-container');
            
            let currentFieldPath = [];
            
            // Configurar subtipos basados en el tipo seleccionado
            function updateSubtypes() {
                const selectedType = typeSelect.value;
                const subtypes = frameTypes[selectedType];
                
                // Limpiar opciones actuales
                subtypeSelect.innerHTML = '';
                
                // Añadir nuevas opciones
                subtypes.forEach(subtype => {
                    const option = document.createElement('option');
                    option.value = subtype.id;
                    option.textContent = subtype.name;
                    if (subtype.selected) {
                        option.selected = true;
                    }
                    subtypeSelect.appendChild(option);
                });
                
                // Actualizar la trama
                updateFrameDisplay();
            }
            
            // Actualizar la visualización de la trama
            function updateFrameDisplay() {
                const selectedType = typeSelect.value;
                const selectedSubtype = subtypeSelect.value;
                const selectedVersion = versionSelect.value;
                
                // Obtener la estructura de la trama
                const frameStructure = frameStructures[selectedType][selectedSubtype];
                
                // Actualizar nombre y tamaño
                const subtypeObj = frameTypes[selectedType].find(st => st.id === selectedSubtype);
                frameName.textContent = `${selectedType.charAt(0).toUpperCase() + selectedType.slice(1)} - ${subtypeObj.name}`;
                frameSize.textContent = subtypeObj.size;
                
                // Generar la tabla de la trama
                let frameHTML = '<table class="frame-table"><tr>';
                
                frameStructure.forEach(field => {
                    frameHTML += `
                        <td class="frame-cell" data-field="${field.id}">
                            ${field.name}<br><span class="bit-size">${field.size}</span>
                        </td>
                    `;
                });
                
                frameHTML += '</tr></table>';
                frameContainer.innerHTML = frameHTML;
                
                // Limpiar detalles de campo
                fieldDetailsContainer.innerHTML = '';
                currentFieldPath = [];
                
                // Agregar event listeners a los campos
                const frameCells = document.querySelectorAll('.frame-cell');
                frameCells.forEach(cell => {
                    cell.addEventListener('click', function() {
                        // Quitar clase activa de todos los campos
                        frameCells.forEach(c => c.classList.remove('active'));
                        
                        // Agregar clase activa al campo actual
                        this.classList.add('active');
                        
                        // Obtener el campo seleccionado
                        const fieldId = this.dataset.field;
                        
                        // Mostrar detalles del campo
                        showFieldDetails(fieldId);
                    });
                });
            }
            
            // Mostrar detalles de un campo
            function showFieldDetails(fieldId) {
                const fieldData = fieldDetails[fieldId];
                
                if (!fieldData) {
                    fieldDetailsContainer.innerHTML = `
                        <div class="no-details">
                            Información detallada no disponible para este campo
                        </div>
                    `;
                    return;
                }
                
                let detailsHTML = `
                    <div class="field-header">
                        <div class="field-name">${fieldData.name}</div>
                        <div class="field-size">${fieldData.size}</div>
                    </div>
                    <div class="field-description">
                        ${fieldData.description}
                    </div>
                `;
                
                // Si el campo tiene subcampos
                if (fieldData.subfields) {
                    detailsHTML += '<div class="field-path">Subcampos:</div>';
                    detailsHTML += '<table class="subfield-table"><tr>';
                    
                    fieldData.subfields.forEach(subfield => {
                        detailsHTML += `
                            <td class="frame-cell" data-field="${subfield.id}">
                                ${subfield.name}<br><span class="bit-size">${subfield.size}</span>
                            </td>
                        `;
                    });
                    
                    detailsHTML += '</tr></table>';
                }
                
                // Si el campo tiene valores definidos
                if (fieldData.values) {
                    detailsHTML += `
                        <div class="values-info">
                            <h3>Valores posibles:</h3>
                            <table class="values-table">
                                <thead>
                                    <tr>
                                        <th>Valor</th>
                                        <th>Significado</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    
                    fieldData.values.forEach(value => {
                        detailsHTML += `
                            <tr>
                                <td class="value">${value.value}</td>
                                <td class="meaning">${value.meaning}</td>
                            </tr>
                        `;
                    });
                    
                    detailsHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                
                fieldDetailsContainer.innerHTML = detailsHTML;
                
                // Agregar event listeners a los subcampos si existen
                const subfieldCells = fieldDetailsContainer.querySelectorAll('.frame-cell');
                subfieldCells.forEach(cell => {
                    cell.addEventListener('click', function() {
                        // Quitar clase activa de todos los subcampos
                        subfieldCells.forEach(c => c.classList.remove('active'));
                        
                        // Agregar clase activa al subcampo actual
                        this.classList.add('active');
                        
                        // Obtener el subcampo seleccionado
                        const subfieldId = this.dataset.field;
                        
                        // Mostrar detalles del subcampo DEBAJO, no reemplazando
                        showSubfieldDetailsBelow(subfieldId);
                    });
                });
            }
            
            // Mostrar detalles de un subcampo DEBAJO del esquema de subcampos
            function showSubfieldDetailsBelow(subfieldId) {
                const subfieldData = fieldDetails[subfieldId];
                // Elimina detalles previos de subcampo si existen
                let prev = document.getElementById('subfield-details');
                if (prev) prev.remove();
                if (!subfieldData) {
                    const noDetails = document.createElement('div');
                    noDetails.className = 'no-details';
                    noDetails.id = 'subfield-details';
                    noDetails.innerHTML = 'Información detallada no disponible para este subcampo';
                    fieldDetailsContainer.appendChild(noDetails);
                    return;
                }
                let detailsHTML = `
                    <div class="field-header">
                        <div class="field-name">${subfieldData.name}</div>
                        <div class="field-size">${subfieldData.size}</div>
                    </div>
                    <div class="field-description">
                        ${subfieldData.description || ''}
                    </div>
                `;
                if (subfieldData.values) {
                    detailsHTML += `
                        <div class="values-info">
                            <h3>Valores posibles:</h3>
                            <table class="values-table">
                                <thead>
                                    <tr>
                                        <th>Valor</th>
                                        <th>Significado</th>
                                    </tr>
                                </thead>
                                <tbody>
                    `;
                    subfieldData.values.forEach(value => {
                        detailsHTML += `
                            <tr>
                                <td class="value">${value.value}</td>
                                <td class="meaning">${value.meaning}</td>
                            </tr>
                        `;
                    });
                    detailsHTML += `
                                </tbody>
                            </table>
                        </div>
                    `;
                }
                const subfieldDiv = document.createElement('div');
                subfieldDiv.className = 'field-details';
                subfieldDiv.id = 'subfield-details';
                subfieldDiv.innerHTML = detailsHTML;
                fieldDetailsContainer.appendChild(subfieldDiv);
            }
            
            // Inicializar subtipos y mostrar primera trama
            updateSubtypes();
            
            // Actualizar cuando cambia cualquier selector
            versionSelect.addEventListener('change', updateFrameDisplay);
            typeSelect.addEventListener('change', updateSubtypes);
            subtypeSelect.addEventListener('change', updateFrameDisplay);
            
            // Simular clic en el primer campo para mostrar detalles iniciales
            setTimeout(() => {
                const firstCell = document.querySelector('.frame-cell');
                if (firstCell) firstCell.click();
            }, 500);
        });
    </script>
</body>
</html>